<div class="p-4">
  <h2 class="text-lg font-semibold mb-4">
    {{ isEditing ? "Edit" : "Add New" }} Activity
  </h2>
  <form [formGroup]="form">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <!-- Name -->
      <div class="md:col-span-2">
        <app-input
          formControlName="nombre"
          label="Activity Name"
          placeholder="Enter activity name"
          [required]="true"
          [validation]="
            form.get('nombre')?.touched && form.get('nombre')?.invalid
              ? {
                  state: 'invalid',
                  message: 'Activity name is required (min 3 characters)'
                }
              : { state: 'undefined', message: '' }
          "
          [fullWidth]="true"
        ></app-input>
      </div>

      <!-- Description -->
      <div class="md:col-span-2">
        <div class="mb-4">
          <label class="block text-sm font-medium mb-2">Description</label>
          <textarea
            formControlName="descripcion"
            placeholder="Enter activity description"
            rows="3"
            class="w-full rounded-md border border-default-300 focus:border-primary focus:ring-2 ring-primary-200 py-2 px-4 bg-content1"
          ></textarea>
        </div>
      </div>

      <!-- Start Date -->
      <div>
        <app-input
          formControlName="fecha_inicio"
          label="Start Date"
          type="date"
          [required]="true"
          [fullWidth]="true"
          [validation]="
            form.get('fecha_inicio')?.touched &&
            form.get('fecha_inicio')?.invalid
              ? { state: 'invalid', message: 'Start date is required' }
              : { state: 'undefined', message: '' }
          "
        ></app-input>
      </div>

      <!-- End Date -->
      <div>
        <app-input
          formControlName="fecha_fin"
          label="End Date"
          type="date"
          [required]="true"
          [fullWidth]="true"
          [validation]="
            form.get('fecha_fin')?.touched && form.get('fecha_fin')?.invalid
              ? { state: 'invalid', message: 'End date is required' }
              : { state: 'undefined', message: '' }
          "
        ></app-input>
      </div>

      <!-- Location -->
      <div>
        <app-input
          formControlName="ubicacion"
          label="Location"
          placeholder="Enter activity location"
          [required]="true"
          [fullWidth]="true"
          [validation]="
            form.get('ubicacion')?.touched && form.get('ubicacion')?.invalid
              ? { state: 'invalid', message: 'Location is required' }
              : { state: 'undefined', message: '' }
          "
        ></app-input>
      </div>

      <!-- Frequency -->
      <div>
        <div class="mb-4">
          <label class="block text-sm font-medium mb-2">
            Frequency
            <span class="text-danger ml-1">*</span>
          </label>
          <select
            formControlName="frecuencia"
            class="w-full rounded-md border border-default-300 focus:border-primary focus:ring-2 ring-primary-200 py-2 px-4 bg-content1"
          >
            <option value="" disabled>Select frequency</option>
            <option value="once">Once</option>
            <option value="daily">Daily</option>
            <option value="weekly">Weekly</option>
            <option value="monthly">Monthly</option>
          </select>
          @if (form.get('frecuencia')?.touched &&
          form.get('frecuencia')?.invalid) {
          <div class="text-danger text-sm mt-1">Frequency is required</div>
          }
        </div>
      </div>

      <!-- Virtual Checkbox -->
      <div class="flex items-center mt-2">
        <input
          type="checkbox"
          id="virtual-checkbox"
          formControlName="virtual"
          class="h-4 w-4 rounded border-default-400 text-primary focus:ring-primary"
        />
        <label for="virtual-checkbox" class="ml-2 text-sm text-default-700">
          Virtual Activity
        </label>
      </div>

      <!-- URL -->
      <div class="md:col-span-2">
        @if (form.get('virtual')?.value) {
        <app-input
          formControlName="url"
          label="URL"
          placeholder="Enter activity URL"
          type="url"
          [fullWidth]="true"
        ></app-input>
        }
      </div>
    </div>
  </form>
  <div class="flex justify-end gap-3 mt-6">
    <app-button (buttonClick)="cancel()" [color]="'default'" intensity="ghost">
      Cancel
    </app-button>
    <app-button
      (buttonClick)="save()"
      [color]="isEditing ? 'primary' : 'success'"
    >
      {{ isEditing ? "Update" : "Save" }} Activity
    </app-button>
  </div>
</div>
